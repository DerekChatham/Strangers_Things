(this.webpackJsonpstrangers_things=this.webpackJsonpstrangers_things||[]).push([[0],{36:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n.n(r),s=n(4),a=n(8),o=n(1),i=n(19),l=n.n(i),u=n(7),p=n(3),j="https://strangers-things.herokuapp.com/api/2108-LSU-RM-WEB-PT",d=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r,s,a,o,i,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,r=t.method,s=t.token,a=t.body,e.prev=1,o={method:r?r.toUpperCase():"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},s&&(o.headers.Authorization="Bearer ".concat(s)),console.log("Call API Request URL: ",j+n),console.log("Call API Options: ",o),e.next=8,fetch(j+n,o);case 8:return i=e.sent,e.next=11,i.json();case 11:if(l=e.sent,console.log("data: ",l),!l.error){e.next=15;break}throw l.error;case 15:return e.abrupt("return",l);case 18:e.prev=18,e.t0=e.catch(1),console.error("ERROR: ",e.t0);case 21:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(t){return e.apply(this,arguments)}}(),h=n(0),b=function(e){var t=e.action,n=e.setToken,r=(e.setUserData,Object(o.useState)("")),i=Object(a.a)(r,2),l=i[0],j=i[1],b=Object(o.useState)(""),O=Object(a.a)(b,2),x=O[0],f=O[1],v="login"===t,g=v?"Login":"Register",m=v?"Register":"Login",k=v?"register":"login",w=Object(p.f)(),y=function(){var e=Object(s.a)(c.a.mark((function e(r){var s,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,d({url:"/users/".concat(t),body:{user:{username:l,password:x}},method:"POST"});case 3:a=e.sent,(o=null===a||void 0===a||null===(s=a.data)||void 0===s?void 0:s.token)&&(localStorage.setItem("token",o),j(""),f(""),n(o),w.push("/"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h2",{children:g}),Object(h.jsxs)("form",{onSubmit:y,children:[Object(h.jsx)("input",{type:"text",placeholder:"username",required:!0,onChange:function(e){return j(e.target.value)}}),Object(h.jsx)("input",{type:"password",placeholder:"password",onChange:function(e){return f(e.target.value)}}),Object(h.jsx)("button",{type:"submit",children:g})]}),Object(h.jsx)(u.b,{to:"/".concat(k),children:m})]})},O={searchContainer:{display:"flex",padding:"16px",alignItems:"center"},searchInput:{margin:"0 16px"}},x=function(){var e=Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(BASE_URL,"/posts/").concat(post._id),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:return t=e.sent,e.next=6,t.json();case 6:e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),f=function(e){var t=e.posts,n=Object(p.f)(),r=Object(o.useState)(""),c=Object(a.a)(r,2),s=c[0],i=c[1],l=t.filter((function(e){return function(e,t){for(var n=t.toLowerCase(),r=0,c=[e.description,e.location,e.title,e.author.username];r<c.length;r++)if(c[r].toLowerCase().includes(n))return!0}(e,s)}));return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{style:O.searchContainer,children:[Object(h.jsx)("h2",{children:"Posts"}),Object(h.jsx)("input",{style:O.searchInput,type:"text",placeholder:"search for posts",value:s,onChange:function(e){console.log(e.target.value),i(e.target.value)}})]}),l.length?l.map((function(e){return Object(h.jsxs)("div",{style:{border:"1px solid black"},children:[Object(h.jsx)("h5",{children:e.title}),Object(h.jsxs)("div",{children:["Posted by: ",e.author.username]}),Object(h.jsxs)("div",{children:["Description: ",e.description]}),Object(h.jsxs)("div",{children:["Location: ",e.location]}),Object(h.jsxs)("div",{id:"buttons",children:[Object(h.jsx)("button",{onClick:function(){return n.push("/posts/".concat(e._id))},children:"View Post"}),Object(h.jsx)("button",{onClick:x,children:"Delete Post"})]})]},e._id)})):Object(h.jsx)("div",{children:"No posts to display"})]})},v=function(e){var t=e.posts,n=Object(p.g)().postId,r=t.find((function(e){return n===e._id}));console.log("SINGLE POST",r);var a=function(){var e=Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(BASE_URL,"/posts/").concat(r._id),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:return t=e.sent,e.next=6,t.json();case 6:e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)(h.Fragment,{children:r?Object(h.jsxs)("div",{children:[Object(h.jsx)("h3",{children:r.title}),Object(h.jsxs)("p",{children:["Posted by: ",r.author.username]}),Object(h.jsxs)("p",{children:["Price: ",r.price]}),Object(h.jsxs)("p",{children:["Location: ",r.location]}),Object(h.jsxs)("p",{children:["Delivers: ",r.willDeliver?"Yes":"No"]}),Object(h.jsx)("div",{children:Object(h.jsx)("button",{onClick:a,children:"Delete Post"})})]}):""})},g=n(11),m=n(12),k=n(18),w=function(e){var t=e.token,n=e.setPosts,r=e.posts,i=e.action,l=Object(p.f)(),u=Object(p.g)().postId,j=Object(o.useState)({title:"",description:"",price:0,location:"",willDeliver:!1}),b=Object(a.a)(j,2),O=b[0],x=b[1],f="edit"===i,v=f?"Edit this post":"Add a new post",w=f?"PATCH":"POST",y=f?"/posts/".concat(u):"/posts",S=function(){var e=Object(s.a)(c.a.mark((function e(s){var a,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.prev=1,e.next=4,d({url:y,method:w,body:{post:{title:O.title,description:O.description,price:O.price,location:O.location,willDeliver:O.willDeliver}},token:t});case 4:a=e.sent,o=a.data.post,f?(i=r.filter((function(e){return e._id!==u})),n([].concat(Object(k.a)(i),[o]))):n([].concat(Object(k.a)(r),[o])),l.push("/posts"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("error adding a post: ",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),C=function(e){return function(t){x("willDeliver"===e?Object(m.a)(Object(m.a)({},O),{},Object(g.a)({},e,t.target.checked)):Object(m.a)(Object(m.a)({},O),{},Object(g.a)({},e,t.target.value)))}};return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h2",{children:v}),Object(h.jsxs)("form",{onSubmit:S,children:[Object(h.jsx)("input",{type:"text",placeholder:"title",onChange:C("title"),value:O.title}),Object(h.jsx)("input",{type:"text",placeholder:"description",onChange:C("description"),value:O.description}),Object(h.jsx)("input",{type:"number",placeholder:"price",onChange:C("price"),value:O.price}),Object(h.jsx)("input",{type:"text",placeholder:"location",onChange:C("location"),value:O.location}),Object(h.jsxs)("label",{children:["Deliver ?",Object(h.jsx)("input",{type:"checkbox",onChange:C("willDeliver"),value:O.willDeliver})]}),Object(h.jsx)("button",{children:v})]})]})},y=function(){var e=Object(o.useState)(""),t=Object(a.a)(e,2),n=t[0],r=t[1],i=Object(o.useState)({}),l=Object(a.a)(i,2),j=l[0],O=l[1],x=Object(o.useState)([]),g=Object(a.a)(x,2),m=g[0],k=g[1],y=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({url:"/users/me",token:t});case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(s.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({url:"/posts"});case 2:return t=e.sent,n=t.data.posts,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.useEffect)(Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return r(localStorage.getItem("token")),e.abrupt("return");case 3:return e.next=5,y(n);case 5:(t=e.sent)&&t.username&&O(t);case 7:case"end":return e.stop()}}),e)}))),[n]),Object(o.useEffect)(Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:t=e.sent,k(t);case 4:case"end":return e.stop()}}),e)}))),[]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h1",{children:"Stranger's Things"}),Object(h.jsxs)("span",{children:[Object(h.jsx)(u.b,{to:"/",children:"Home"}),Object(h.jsx)(u.b,{to:"/login",children:"Login"}),Object(h.jsx)(u.b,{to:"/posts/new",children:"Add A Post"}),Object(h.jsx)(u.b,{to:"/posts",children:"See All Post"})]}),Object(h.jsxs)(p.c,{children:[Object(h.jsx)(p.a,{exact:!0,path:"/",children:j.username&&Object(h.jsxs)("div",{children:["Hello ",j.username]})}),Object(h.jsx)(p.a,{exact:!0,path:"/posts",children:Object(h.jsx)(f,{posts:m})}),Object(h.jsx)(p.a,{path:"/posts/new",children:Object(h.jsx)(w,{token:n,setPosts:k,posts:m,action:"add"})}),Object(h.jsx)(p.a,{path:"/posts/:postId/edit",children:Object(h.jsx)(w,{token:n,setPosts:k,posts:m,action:"edit"})}),Object(h.jsx)(p.a,{path:"/posts/:postId",children:Object(h.jsx)(v,{posts:m})}),Object(h.jsx)(p.a,{path:"/register",children:Object(h.jsx)(b,{action:"register",setToken:r,setUserData:O})}),Object(h.jsx)(p.a,{path:"/login",children:Object(h.jsx)(b,{action:"login",setToken:r,setUserData:O})})]})]})};l.a.render(Object(h.jsx)(u.a,{children:Object(h.jsx)(y,{})}),document.getElementById("app"))}},[[36,1,2]]]);
//# sourceMappingURL=main.834498ba.chunk.js.map